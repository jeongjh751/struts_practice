<?xml version="1.0" encoding="UTF-8"?>
<Configuration status="WARN">
    <!-- status="WARN": Log4j自体のログレベル（通常はWARNでOK） -->
    
    <!-- ========== Appenders: ログの出力先を定義 ========== -->
    <Appenders>
        
        <!-- コンソール出力 -->
        <Console name="Console" target="SYSTEM_OUT">
            <PatternLayout pattern="[%d{yyyy-MM-dd HH:mm:ss.SSS}] [%-5level] [%c{1}:%L] - %msg%n"/>
        </Console>
        
        <!-- 全体ログファイル: すべてのログレベル -->
        <RollingFile name="AppLogFile" 
                     fileName="C:/apache-tomcat-9.0.55/logs/application.log"
                     filePattern="C:/apache-tomcat-9.0.55/logs/application-%d{yyyy-MM-dd}-%i.log">
<!--        <RollingFile name="AppLogFile" -->
<!--             fileName="logs/application.log"-->
<!--             filePattern="logs/application-%d{yyyy-MM-dd}-%i.log">-->
            <PatternLayout>
                <pattern>[%d{yyyy-MM-dd HH:mm:ss}] [%-5level] [%c{1}:%L] - %msg%n</pattern>
            </PatternLayout>
            <Policies>
                <SizeBasedTriggeringPolicy size="10MB"/>
                <TimeBasedTriggeringPolicy interval="1"/>
            </Policies>
            <DefaultRolloverStrategy max="10"/>
        </RollingFile>
        
        <!-- DEBUGログファイル: DEBUG以上 -->
        <RollingFile name="DebugLogFile" 
                     fileName="C:/apache-tomcat-9.0.55/logs/debug.log"
                     filePattern="C:/apache-tomcat-9.0.55/logs/debug-%d{yyyy-MM-dd}-%i.log">
            <PatternLayout>
                <pattern>[%d{yyyy-MM-dd HH:mm:ss}] [%-5level] [%c{1}:%L] - %msg%n</pattern>
            </PatternLayout>
            <Policies>
                <SizeBasedTriggeringPolicy size="10MB"/>
                <TimeBasedTriggeringPolicy interval="1"/>
            </Policies>
            <DefaultRolloverStrategy max="5"/>
            <!-- DEBUG以上のみ -->
            <ThresholdFilter level="DEBUG" onMatch="ACCEPT" onMismatch="DENY"/>
        </RollingFile>
        
        <!-- INFOログファイル: INFO以上 -->
        <RollingFile name="InfoLogFile" 
                     fileName="C:/apache-tomcat-9.0.55/logs/info.log"
                     filePattern="C:/apache-tomcat-9.0.55/logs/info-%d{yyyy-MM-dd}-%i.log">
            <PatternLayout>
                <pattern>[%d{yyyy-MM-dd HH:mm:ss}] [%-5level] [%c{1}:%L] - %msg%n</pattern>
            </PatternLayout>
            <Policies>
                <SizeBasedTriggeringPolicy size="10MB"/>
                <TimeBasedTriggeringPolicy interval="1"/>
            </Policies>
            <DefaultRolloverStrategy max="5"/>
            <!-- INFO以上のみ -->
            <ThresholdFilter level="INFO" onMatch="ACCEPT" onMismatch="DENY"/>
        </RollingFile>
        
        <!-- ERRORログファイル: ERROR以上 -->
        <RollingFile name="ErrorLogFile" 
                     fileName="C:/apache-tomcat-9.0.55/logs/error.log"
                     filePattern="C:/apache-tomcat-9.0.55/logs/error-%d{yyyy-MM-dd}-%i.log">
            <PatternLayout>
                <pattern>[%d{yyyy-MM-dd HH:mm:ss}] [%-5level] [%c{1}:%L] - %msg%n</pattern>
            </PatternLayout>
            <Policies>
                <SizeBasedTriggeringPolicy size="10MB"/>
                <TimeBasedTriggeringPolicy interval="1"/>
            </Policies>
            <DefaultRolloverStrategy max="10"/>
            <!-- ERROR以上のみ -->
            <ThresholdFilter level="ERROR" onMatch="ACCEPT" onMismatch="DENY"/>
        </RollingFile>
        
    </Appenders>
    
    <Loggers>
        
        <!-- 自分のパッケージ（package名に合わせて変更） -->
        <Logger name="action" level="DEBUG" additivity="false">
            <AppenderRef ref="Console"/>
            <AppenderRef ref="AppLogFile"/>
            <AppenderRef ref="DebugLogFile"/>
            <AppenderRef ref="InfoLogFile"/>
            <AppenderRef ref="ErrorLogFile"/>
        </Logger>
        
        <Logger name="model" level="DEBUG" additivity="false">
            <AppenderRef ref="Console"/>
            <AppenderRef ref="AppLogFile"/>
            <AppenderRef ref="DebugLogFile"/>
            <AppenderRef ref="InfoLogFile"/>
            <AppenderRef ref="ErrorLogFile"/>
        </Logger>
        
        <Logger name="sample" level="DEBUG" additivity="false">
            <AppenderRef ref="Console"/>
            <AppenderRef ref="AppLogFile"/>
            <AppenderRef ref="DebugLogFile"/>
            <AppenderRef ref="InfoLogFile"/>
            <AppenderRef ref="ErrorLogFile"/>
        </Logger>
        
        <!-- Struts2フレームワーク: WARNレベル -->
        <Logger name="com.opensymphony.xwork2" level="WARN"/>
        <Logger name="org.apache.struts2" level="WARN"/>
        
        <!-- データベース関連 -->
        <Logger name="java.sql" level="DEBUG"/>
        <Logger name="org.postgresql" level="WARN"/>
        
        <!-- ルートロガー: すべてのログのデフォルト設定 -->
        <Root level="DEBUG">
            <AppenderRef ref="Console"/>
            <AppenderRef ref="AppLogFile"/>
            <AppenderRef ref="DebugLogFile"/>
            <AppenderRef ref="InfoLogFile"/>
            <AppenderRef ref="ErrorLogFile"/>
        </Root>
    </Loggers>
</Configuration>
